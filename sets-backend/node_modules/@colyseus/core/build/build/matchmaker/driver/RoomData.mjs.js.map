{"version":3,"file":"RoomData.mjs.js","sources":["../../../matchmaker/driver/RoomData.mjs"],"sourcesContent":["import { spliceOne } from '../../Utils.mjs';\n\nclass RoomCache {\n    clients = 0;\n    locked = false;\n    private = false;\n    maxClients = Infinity;\n    metadata;\n    name;\n    processId;\n    roomId;\n    createdAt;\n    unlisted = false;\n    $rooms;\n    constructor(initialValues, rooms) {\n        this.createdAt = new Date();\n        for (const field in initialValues) {\n            if (initialValues.hasOwnProperty(field)) {\n                this[field] = initialValues[field];\n            }\n        }\n        this.$rooms = rooms;\n    }\n    toJSON() {\n        return {\n            clients: this.clients,\n            createdAt: this.createdAt,\n            maxClients: this.maxClients,\n            metadata: this.metadata,\n            name: this.name,\n            processId: this.processId,\n            roomId: this.roomId,\n        };\n    }\n    save() {\n        if (this.$rooms.indexOf(this) === -1) {\n            this.$rooms.push(this);\n        }\n    }\n    updateOne(operations) {\n        if (operations.$set) {\n            for (const field in operations.$set) {\n                if (operations.$set.hasOwnProperty(field)) {\n                    this[field] = operations.$set[field];\n                }\n            }\n        }\n        if (operations.$inc) {\n            for (const field in operations.$inc) {\n                if (operations.$inc.hasOwnProperty(field)) {\n                    this[field] += operations.$inc[field];\n                }\n            }\n        }\n    }\n    remove() {\n        //\n        // WORKAROUND: prevent calling `.remove()` multiple times\n        // Seems to happen during disconnect + dispose: https://github.com/colyseus/colyseus/issues/390\n        //\n        if (!this.$rooms) {\n            return;\n        }\n        const roomIndex = this.$rooms.indexOf(this);\n        if (roomIndex === -1) {\n            return;\n        }\n        spliceOne(this.$rooms, roomIndex);\n        this.$rooms = null;\n    }\n}\n\nexport { RoomCache };\n//# sourceMappingURL=RoomData.mjs.map\n"],"names":["spliceOne"],"mappings":"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"}